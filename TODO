* Rework the menu system code to be more cohesive and avoid repetition